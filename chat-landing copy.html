<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Live in Oz Chat Room</title>
    <link rel="stylesheet" href="global.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="chat-landing.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- small hero CSS kept here so you can paste the whole file as-is -->
  </head>

  <body>
    <!-- Navigation bar will be loaded here -->
    <div id="navbar-placeholder"></div>

    <script src="auth-php.js"></script>

    <!-- optional neon logo (uses uploaded file path) -->
    <!-- <img
      src="/mnt/data/eccd579d-7480-4cda-bfe1-04020a04f537.png"
      alt="neon logo"
      class="neon-logo"
    /> -->

    <!-- CENTRAL NEON CARD: rules + T&Cs + buttons -->
    <div class="chat-hero">
      <h1>CHAT RULES</h1>

      <div class="rules-container">
        <div class="rule-box">
       <h2>PLAY NICE ‚úÖ</h2>
            <ul>
              <li>Be friendly and respectful to everyone.</li>
              <li>Chat languages: English / Spanish / Portuguese only.</li>
              <li>Use the correct room for each topic (jobs, housing, meetups, etc.).</li>
              <li>Protect your privacy ‚Äì don't post full addresses, documents or personal IDs in the chat.</li>
              <li>Share only photos, videos and files you own or have permission to share.</li>
              <li>Report bad behaviour, scammers or fake profiles to admins as soon as you see them.</li>
              <li>Help newcomers, answer questions and support the community.</li>
              <li>Keep it fun ‚Äì no constant drama, arguments or flooding the chat.</li>
            </ul>

        </div>

        <div class="rule-box">
         <h2>NOT ALLOWED ‚ùå</h2>
            <ul>
              <li>No discrimination or hate speech (race, gender, nationality, religion, sexuality, etc.).</li>
              <li>No bullying, harassment, threats or stalking.</li>
              <li>No spam, mass advertising or "get rich quick / investment" offers.</li>
              <li>No scams ‚Äì don't ask anyone to pay before visiting a place and having a proper agreement.</li>
              <li>No explicit sexual content, nudity or illegal content.</li>
              <li>No impersonation or fake identities / photos.</li>
              <li>No sharing of other people's private info (phone, address, documents, etc.) without consent.</li>
              <li>No bots or tools that scrape / collect user data.</li>
              <li>No content promoting self-harm, suicide or dangerous / illegal activities.</li>
              <li>Repeated rule breaks can lead to temporary or permanent ban.</li>
            </ul>
        </div>
      </div>

      <!-- Terms & Conditions Section -->
      <div class="terms-section">
        <h1>Chat Room Terms & Conditions (summary)</h1>
        <p>By entering the chat you agree to follow these rules and you accept our Terms & Conditions and Privacy Policy.</p>
        <p>We may store your messages, profile details, IP address and any files you share to keep the community safe, improve the service and investigate abuse.</p>
        <p>The chat may ask for access to your gallery, camera, microphone and files so you can send photos, videos and voice messages. You can turn these permissions off in your device settings at any time.</p>
        <a href="terms-of-use.html" target="_blank">Read full Terms & Privacy Policy</a>
        <br><br>
        <label for="acceptCheckbox">
          <input type="checkbox" id="acceptCheckbox">
          I accept the Chat Rules & Terms and I am over 18.
        </label>
      </div>

      <div id="loginRequired" style="display: none">
        <h2>üîí Login Required</h2>
        <p>You need to be logged in to access the chat room.</p>
        <a
          href="login.html"
          style="
            margin: 5px;
            padding: 10px 25px;
            border: 1px solid #00ffff;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.7);
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
          "
          >Login</a
        >
        <a
          href="signup.html"
          style="
            margin: 5px;
            padding: 10px 25px;
            border: 1px solid #00ffff;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.7);
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
          "
          >Sign Up</a
        >
      </div>

      <!-- Chat buttons (hidden by default) ‚Äî inline preserved -->
      <div class="button-group" id="chatButtons" style="display: none">
        <button onclick="enterChat()" class="enter-btn" id="enterBtn" disabled>Enter</button>
        <a href="index.html" class="leave-btn">Leave</a>
      </div>
    </div>

    <!-- Footer will be loaded here -->
    <div id="footer-placeholder"></div>

    <!-- KEEP THIS SCRIPT: authentication + enterChat (essential) -->
    <script>
      // Check authentication on page load
      document.addEventListener("DOMContentLoaded", function () {
        checkAuthentication();
        setupCheckbox();
      });

      async function checkAuthentication() {
        try {
          const authenticated = await isAuthenticated();

          if (authenticated) {
            // Show the chat buttons
            document.getElementById("chatButtons").style.display = "block";

            // If rules already accepted, pre-check the checkbox and enable enter button
            if (localStorage.getItem('chatRulesAccepted') === 'true') {
              document.getElementById("acceptCheckbox").checked = true;
              document.getElementById("enterBtn").disabled = false;
            }
          } else {
            // Show login required message
            document.getElementById("loginRequired").style.display = "block";

            // Store current page for redirect after login
            localStorage.setItem("redirectAfterLogin", window.location.href);
          }
        } catch (error) {
          console.error("Authentication check error:", error);
          // Show login required message as fallback
          document.getElementById("loginRequired").style.display = "block";
        }
      }

      function setupCheckbox() {
        const checkbox = document.getElementById("acceptCheckbox");
        const enterBtn = document.getElementById("enterBtn");

        checkbox.addEventListener("change", function() {
          enterBtn.disabled = !this.checked;
        });
      }

      function enterChat() {
        // Set flag that rules are accepted
        localStorage.setItem('chatRulesAccepted', 'true');
        // Redirect to chat directory
        window.location.href = "chat-directory.html";
      }
    </script>

    <!-- Load the navigation bar -->
    <script src="nav-loader.js"></script>
    <!-- Load the footer -->
    <script src="footer-loader.js"></script>
  </body>
</html>
